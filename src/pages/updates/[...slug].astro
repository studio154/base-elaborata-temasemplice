---
import { getCollection } from "astro:content";
import BaseLayout from "@/layouts/BaseLayout.astro";
import CtaTwo from "@/components/cta/CtaTwo.astro";
import { getFormattedDate } from "@/utils/utils";

export async function getStaticPaths() {
  const updates = await getCollection("updates");
  return updates.map((update) => ({
    params: {
      slug: update.slug,
    },
    props: { update },
  }));
}

const { data: update, render } = Astro.props.update;
const { Content } = await render();
---

<BaseLayout>
  <section>
    <div class="w-full px-8 py-12 mx-auto md:px-12 lg:px-24 max-w-7xl lg:py-32">
      <div class="max-w-xl items-center">
        <span
          class="font-semibold text-accent-500 text-sm tracking-widest uppercase"
        >
          {update.category} - <span class="text-black"
            >{getFormattedDate(update.publishedAt)}</span
          >
        </span>
        <p class="text-4xl mt-8 font-extrabold tracking-tight text-black">
          {update.name}
        </p>
      </div>
      <div class="bg-slate-100 p-8 mt-12 rounded-3xl">
        <img
          alt={update.image.alt}
          class="relative w-full border rounded-2xl object-cover shadow-2xl"
          src={update.image.url}
        />
      </div>
      <div
        class="prose mt-12 mx-auto prose-blockquote:border-l-black prose-a:text-accent-500 hover:prose-a:text-black prose-headings:font-bold prose-headings:text-black prose-li:marker:text-accent-500 text-slate-500 prose-code:text-black prose-blockquote:text-slate-500 max-w-3xl"
      >
        <Content />
        <div
          class="flex flex-col gap-3 mt-10 sm:flex-row items-center not-prose"
        >
          <a
            class="items-center gap-3 text-white focus:outline-none inline-flex justify-center hover:text-accent-500 duration-200 focus-visible:outline-black focus-visible:ring-black font-medium lg:w-auto px-6 py-3 rounded-xl text-center w-full bg-accent-500 hover:bg-accent-100"
            href="#"
          >
            <span>
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="icon icon-tabler icon-tabler-brand-twitter"
                width="18"
                height="18"
                viewBox="0 0 24 24"
                stroke-width="2"
                stroke="currentColor"
                fill="none"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
                <path
                  d="M22 4.01c-1 .49 -1.98 .689 -3 .99c-1.121 -1.265 -2.783 -1.335 -4.38 -.737s-2.643 2.06 -2.62 3.737v1c-3.245 .083 -6.135 -1.395 -8 -4c0 0 -4.182 7.433 4 11c-1.872 1.247 -3.739 2.088 -6 2c3.308 1.803 6.913 2.423 10.034 1.517c3.58 -1.04 6.522 -3.723 7.651 -7.742a13.84 13.84 0 0 0 .497 -3.753c0 -.249 1.51 -2.772 1.818 -4.013z"
                >
                </path>
              </svg>
            </span>
            <span>Tweet</span>
          </a>
        </div>
      </div>
    </div>
  </section>

  <CtaTwo />
</BaseLayout>
